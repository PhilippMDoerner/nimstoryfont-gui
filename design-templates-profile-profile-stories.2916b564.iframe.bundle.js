(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[8823],{"./src/app/_models/token.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{u:()=>CampaignRoles});const CampaignRoles=["member","admin","guest","globalguest","globalmember"]},"./src/app/_services/formly/formly-service.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{$:()=>FormlyService});var tslib__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),rxjs__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),rxjs__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/operators/map.js"),src_design_organisms_formly_select_disable_formly_select_disable_field_component__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/design/organisms/formly-select-disable/formly-select-disable-field.component.ts"),src_utils_array__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./src/utils/array.ts"),src_utils_string__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/string.ts");let FormlyService=class FormlyService{buildOverviewSelectConfig(config){const options$=config.required??!0?config.options$:this.addEmptyOption(config.options$,config),sortedOptions$=this.sortOptions(options$,config),validators=this.getValidators(config);return{key:config.key,type:"select",className:config.className,wrappers:config.wrappers,hideExpression:config.hide,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),labelProp:config.labelProp,valueProp:config.valueProp??"pk",options:sortedOptions$,required:config.required??!0,disabled:config.disabled},validators:{validation:validators}}}buildDisableSelectConfig(config){const options$=config.required??!0?config.options$:this.addEmptyOption(config.options$,config),sortedOptions$=this.sortOptions(options$,config),validators=this.getValidators(config);return{key:config.key,type:"select-disable",className:config.className,wrappers:config.wrappers,hideExpression:config.hide??!1,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),labelProp:config.labelProp,valueProp:config.valueProp??"pk",options:sortedOptions$,required:config.required??!0,warningMessage:config.warningMessage,additionalProperties:{disabledExpression:config.disabledExpression,tooltipMessage:config.tooltipMessage??"WHAT",showWrapperLabel:config.showWrapperLabel??!0}},validators:{validation:validators}}}buildStaticSelectConfig(config){const validators=this.getValidators(config);return{key:config.key,type:"select",className:config.className,wrappers:config.wrappers,hideExpression:config.hide??!1,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),options:config.options,required:config.required??!0,disabled:config.disabled},validators:{validation:validators}}}buildStaticStringSelectConfig(partialConfig){let options=partialConfig.options.map((str=>({label:str,value:str})));const config={...partialConfig,options};return this.buildStaticSelectConfig(config)}buildInputConfig(config){const validators=this.getValidators(config);let innerInputType;if("NUMBER"===config.inputKind&&validators.push("notInteger"),"NAME"===config.inputKind&&validators.push("hasSpecialCharacters"),"NUMBER"===config.inputKind)innerInputType="number";else innerInputType="string";return{key:config.key,type:"input",className:config.className,wrappers:config.wrappers,hideExpression:config.hide??!1,parsers:config.parsers,props:{maxLength:config.maxLength,minLength:config.minLength,label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),type:innerInputType,required:config.required??!0,disabled:!!config.disabled,placeholder:config.placeholder??void 0},validators:{validation:validators}}}buildSinglePasswordConfig(config){const validators=this.getValidators(config);return{key:config.key,type:"input",className:config.className,fieldGroupClassName:config.fieldGroupClassName,templateOptions:{label:config.label??"Password",type:"password",required:!0,placeholder:"Your password",disabled:config.disabled},validators:{validation:validators}}}buildConfirmedPasswordConfig(config){const validators=config.validators??[];validators.push("required");return{validators:{validation:[{name:"fieldMatch",options:{errorPath:"passwordConfirm"}}]},fieldGroup:[{key:"password",type:"input",className:config.className,templateOptions:{label:config.label??"Password",type:"password",required:!0,placeholder:"Password, at least 7 characters",disabled:config.disabled},validators:{validation:validators}},{key:"passwordConfirm",type:"input",className:config.className,templateOptions:{label:config.label?"Confirm "+config.label:"Password Confirmation",type:"password",required:!0,placeholder:"Please re-enter your password",disabled:config.disabled}}]}}buildCheckboxConfig(config){return{key:config.key,type:"checkbox",className:config.className,wrappers:config.wrappers,defaultValue:config.defaultValue,hideExpression:config.hide,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),required:config.required??!0,disabled:config.disabled}}}buildDatepickerConfig(config){const validators=this.getValidators(config);return validators.push("date"),{key:config.key,type:"datepicker",className:config.className,wrappers:config.wrappers,hideExpression:config.hide,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),required:config.required??!0,disabled:config.disabled},validators:{validation:validators}}}buildFileFieldConfig(config){const validators=this.getValidators(config);return{key:config.key,type:"file",className:config.className,wrappers:config.wrappers,hideExpression:config.hide,props:{buttonType:config.fileButtonType??"SECONDARY",fileFieldKind:config.fileFieldKind??"IMAGE",label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),required:config.required??!0,disabled:!!config.disabled},validators:{validation:validators}}}buildEditorConfig(config){const validators=this.getValidators(config);return{key:config.key,type:"text-editor",className:config.className,wrappers:config.wrappers,hideExpression:config.hide,props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),required:config.required??!0,disabled:config.disabled},validators:{validation:validators}}}buildAutocompleteConfig(config){const validators=this.getValidators(config);return{key:config.key,type:"autocomplete",className:config.className,wrappers:[...config.wrappers??[],"form-field"],props:{label:config.label??(0,src_utils_string__WEBPACK_IMPORTED_MODULE_1__.ZH)(config.key),required:config.required??!0,disabled:config.disabled,additionalProperties:{optionLabelProp:config.optionLabelProp,optionValueProp:config.optionValueProp,optionKeyProp:config.optionKeyProp,loadOptions:config.loadOptions,initialValue$:config.initialValue$}},validators:{validation:validators}}}toUpdateForm(fields){return fields.filter((field=>!("file"===field.type)))}getValidators(config){const validators=config.validators??[];return config.required&&validators.push("required"),validators}addEmptyOption(list,config){return Array.isArray(list)?(0,rxjs__WEBPACK_IMPORTED_MODULE_2__.of)([this.createEmptyOption(config),...list]):list.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.T)((values=>[this.createEmptyOption(config),...values])))}createEmptyOption(config){const emptyOption={};emptyOption[config.labelProp]=src_design_organisms_formly_select_disable_formly_select_disable_field_component__WEBPACK_IMPORTED_MODULE_0__.D.EMPTY_OPTION_LABEL;return emptyOption[config.valueProp??config.key]=src_design_organisms_formly_select_disable_formly_select_disable_field_component__WEBPACK_IMPORTED_MODULE_0__.D.EMPTY_OPTION_VALUE,emptyOption}sortOptions(list$,config){const{sortProp,sortDirection}=config;return sortProp?list$.pipe((0,rxjs__WEBPACK_IMPORTED_MODULE_3__.T)((list=>(0,src_utils_array__WEBPACK_IMPORTED_MODULE_4__.Z)(list,sortProp,sortDirection??"asc")))):list$}};FormlyService=(0,tslib__WEBPACK_IMPORTED_MODULE_5__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_6__.Injectable)({providedIn:"root"})],FormlyService)},"./src/app/_services/utils/token.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{B:()=>TokenService});var TokenService_1,tslib__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),_angular_common_http__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/common/fesm2022/http.mjs"),_angular_core__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),src_app_models_token__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./src/app/_models/token.ts"),src_environments_environment__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./src/environments/environment.ts"),src_utils_logging__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./src/utils/logging.ts");let TokenService=class TokenService{static{TokenService_1=this}static{this.USER_DATA_KEY="user_data"}constructor(http){this.http=http,this.apiUrl=src_environments_environment__WEBPACK_IMPORTED_MODULE_0__.c.apiUrl,this.jwtTokenUrl=`${this.apiUrl}/token`,this.refreshTokenUrl=`${this.apiUrl}/token/refresh`,this.ID_IDENTIFIER_PREFIX="id_"}login(loginData){return this.http.post(this.jwtTokenUrl,loginData)}logout(){}refreshUserData(){(0,src_utils_logging__WEBPACK_IMPORTED_MODULE_1__.R)(this.refreshUserData.name);const refreshToken=TokenService_1.getRefreshToken()?.token;if(!refreshToken)return;const httpHeaders=(new _angular_common_http__WEBPACK_IMPORTED_MODULE_2__.Lr).set("Authorization",`Bearer ${refreshToken}`);return this.http.post(this.refreshTokenUrl,{refresh:refreshToken},{headers:httpHeaders})}invalidateJWTToken(){}static getUserData(){const rawUserData=localStorage.getItem(TokenService_1.USER_DATA_KEY);return null!=rawUserData&&"undefined"!==rawUserData?JSON.parse(rawUserData):void 0}static getAccessToken(){return this.getUserData()?.accessToken}static getRefreshToken(){return this.getUserData()?.refreshToken}setUserData(data){localStorage.setItem(TokenService_1.USER_DATA_KEY,JSON.stringify(data))}getCampaignRole(data,campaignName){if(null==campaignName)return;const memberships=this.getCampaignMemberships(data);if(null==memberships)return;const role=memberships[campaignName.toLowerCase()];return src_app_models_token__WEBPACK_IMPORTED_MODULE_3__.u.some((roleName=>roleName===role))?role:void 0}getCampaignMemberships(data){if(null==data)return;const campaignMemberships={};for(const campaignIdentifier of Object.keys(data.campaignMemberships)){campaignIdentifier.startsWith(this.ID_IDENTIFIER_PREFIX)||(campaignMemberships[campaignIdentifier.toLowerCase()]=data.campaignMemberships[campaignIdentifier])}return campaignMemberships}isAccessTokenExpired(){return this.isTokenExpired(TokenService_1.getAccessToken())}isRefreshTokenExpired(){return this.isTokenExpired(TokenService_1.getRefreshToken())}isTokenExpired(token){if(null==token)return!0;const expiryTimestamp=token.exp,currentTimestamp=Math.floor((new Date).getTime()/1e3),isExpired=currentTimestamp>=expiryTimestamp;if(isExpired){const currentDate=new Date(1e3*currentTimestamp).toString(),expiryDate=new Date(1e3*expiryTimestamp).toString(),tokenName=token.type.toLocaleUpperCase();console.log(`\n        ${tokenName} Token is expired. \n        Request timestamp: ${currentDate}. \n        Token expiry timestamp: ${expiryDate}\n      `)}return isExpired}static{this.ctorParameters=()=>[{type:_angular_common_http__WEBPACK_IMPORTED_MODULE_2__.Qq}]}};TokenService=TokenService_1=(0,tslib__WEBPACK_IMPORTED_MODULE_4__.Cg)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_5__.Injectable)({providedIn:"root"})],TokenService)},"./src/design/atoms/card/card.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>CardComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var card_componentngResource=__webpack_require__("./src/design/atoms/card/card.component.scss?ngResource"),card_componentngResource_default=__webpack_require__.n(card_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs");let CardComponent=class CardComponent{};CardComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"app-card",template:'<div class="card">\n  <ng-content></ng-content>\n</div>',changeDetection:core.ChangeDetectionStrategy.OnPush,standalone:!0,imports:[],styles:[card_componentngResource_default()]})],CardComponent)},"./src/design/organisms/page-container/page-container.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{i:()=>PageContainerComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs");var page_container_componentngResource=__webpack_require__("./src/design/organisms/page-container/page-container.component.scss?ngResource"),page_container_componentngResource_default=__webpack_require__.n(page_container_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),animations=__webpack_require__("./node_modules/@angular/animations/fesm2022/animations.mjs");const fadeIn=(0,animations.hZ)("fadeIn",[(0,animations.kY)(":enter",[(0,animations.iF)({opacity:0}),(0,animations.i0)("250ms ease-in",(0,animations.iF)({opacity:1}))]),(0,animations.kY)(":leave",[(0,animations.iF)({opacity:1}),(0,animations.i0)("250ms ease-out",(0,animations.iF)({opacity:0}))])]);(0,animations.hZ)("fadeOut",[(0,animations.kY)(":leave",[(0,animations.iF)({opacity:1}),(0,animations.i0)("250ms ease-out",(0,animations.iF)({opacity:0}))])]);let PageContainerComponent=class PageContainerComponent{};PageContainerComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"app-page-container",template:'<div class="page" [@fadeIn]>\n  <article class="page__foreground">\n    <ng-content></ng-content>\n  </article>\n</div>\n',standalone:!0,imports:[],animations:[fadeIn],styles:[page_container_componentngResource_default()]})],PageContainerComponent)},"./src/utils/array.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{U1:()=>replaceItem,Z:()=>sortByProp});const replaceItem=(list,item,key)=>{const newList=[...list],itemIndex=newList.findIndex((listItem=>listItem[key]===item[key]));if(-1===itemIndex)throw"Failed to find item in list";return newList[itemIndex]=item,newList},sortByProp=(list,prop,sortDirection="asc")=>{const newList=[...list];return newList.sort(((a,b)=>{const sortValue=a[prop]>b[prop]?1:-1;return"desc"===sortDirection?-1*sortValue:sortValue})),newList}},"./node_modules/@storybook/addon-actions/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{XI:()=>action});var external_STORYBOOK_MODULE_PREVIEW_API_=__webpack_require__("storybook/internal/preview-api"),external_STORYBOOK_MODULE_CORE_EVENTS_PREVIEW_ERRORS_=__webpack_require__("storybook/internal/preview-errors"),external_STORYBOOK_MODULE_GLOBAL_=__webpack_require__("@storybook/global"),v4=__webpack_require__("./node_modules/uuid/dist/esm-browser/v4.js"),ADDON_ID="storybook/actions",EVENT_ID=`${ADDON_ID}/action-event`,config={depth:10,clearOnStoryChange:!0,limit:50},findProto=(obj,callback)=>{let proto=Object.getPrototypeOf(obj);return!proto||callback(proto)?proto:findProto(proto,callback)},serializeArg=a=>{if("object"==typeof(e=a)&&e&&findProto(e,(proto=>/^Synthetic(?:Base)?Event$/.test(proto.constructor.name)))&&"function"==typeof e.persist){let e=Object.create(a.constructor.prototype,Object.getOwnPropertyDescriptors(a));e.persist();let viewDescriptor=Object.getOwnPropertyDescriptor(e,"view"),view=viewDescriptor?.value;return"object"==typeof view&&"Window"===view?.constructor.name&&Object.defineProperty(e,"view",{...viewDescriptor,value:Object.create(view.constructor.prototype)}),e}var e;return a},generateId=()=>"object"==typeof crypto&&"function"==typeof crypto.getRandomValues?(0,v4.A)():Date.now().toString(36)+Math.random().toString(36).substring(2);function action(name,options={}){let actionOptions={...config,...options},handler=function(...args){if(options.implicit){let storyRenderer=("__STORYBOOK_PREVIEW__"in external_STORYBOOK_MODULE_GLOBAL_.global?external_STORYBOOK_MODULE_GLOBAL_.global.__STORYBOOK_PREVIEW__:void 0)?.storyRenders.find((render=>"playing"===render.phase||"rendering"===render.phase));if(storyRenderer){let deprecated=!window?.FEATURES?.disallowImplicitActionsInRenderV8,error=new external_STORYBOOK_MODULE_CORE_EVENTS_PREVIEW_ERRORS_.ImplicitActionsDuringRendering({phase:storyRenderer.phase,name,deprecated});if(!deprecated)throw error;console.warn(error)}}let channel=external_STORYBOOK_MODULE_PREVIEW_API_.addons.getChannel(),id=generateId(),serializedArgs=args.map(serializeArg),normalizedArgs=args.length>1?serializedArgs:serializedArgs[0],actionDisplayToEmit={id,count:0,data:{name,args:normalizedArgs},options:{...actionOptions,maxDepth:5+(actionOptions.depth||3),allowFunction:actionOptions.allowFunction||!1}};channel.emit(EVENT_ID,actionDisplayToEmit)};return handler.isAction=!0,handler.implicit=options.implicit,handler}},"./src/design/templates/profile/profile.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,__namedExportsOrder:()=>__namedExportsOrder,default:()=>profile_stories});var TokenMockService_1,testing=__webpack_require__("./node_modules/@angular/router/fesm2022/testing.mjs"),dist=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),angular_dist=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),formly_constants=__webpack_require__("./src/app/_modules/formly_constants.ts"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.mjs"),core=__webpack_require__("./node_modules/@angular/core/fesm2022/core.mjs"),of=__webpack_require__("./node_modules/rxjs/dist/esm5/internal/observable/of.js"),token=__webpack_require__("./src/app/_models/token.ts");const dummyUserData={accessToken:{token:"abcdef123456",exp:1678923456,type:"access"},refreshToken:{token:"ghijkl789012",exp:1678923456,type:"refresh"},userId:123,userName:"john_doe",isAdmin:!0,isSuperUser:!1,campaignMemberships:{campaign1:"admin",campaign2:"member",campaign3:"guest"}};let TokenMockService=TokenMockService_1=class TokenMockService{constructor(){this.ID_IDENTIFIER_PREFIX="id_"}login(userModel){return(0,of.of)(dummyUserData)}refreshUserData(){return(0,of.of)(dummyUserData)}invalidateJWTToken(){}static getUserData(){return dummyUserData}hasTokens(){return null!=TokenMockService_1.getUserData()&&(!!TokenMockService_1.getAccessToken()&&!!TokenMockService_1.getRefreshToken())}hasValidJWTToken(){return!!this.hasTokens()&&!this.isTokenExpired(TokenMockService_1.getRefreshToken())}static getAccessToken(){return this.getUserData().accessToken}static getRefreshToken(){return this.getUserData().refreshToken}setUserData(data){console.log("set user data: ",data)}removeJWTTokenFromLocalStorage(){console.log("removeJWTTokenFromLocalStorage")}getCurrentUserPk(){return TokenMockService_1.getUserData().userId}isAdmin(){const data=TokenMockService_1.getUserData();return null!=data&&data.isAdmin}isSuperUser(){const data=TokenMockService_1.getUserData();return null!=data&&data.isSuperUser}getCurrentUserName(){return TokenMockService_1.getUserData()?.userName}isCampaignMember(campaignName){const role=this.getCampaignRole(campaignName);return null!=role&&(this.isSuperUser()||this.isAdmin()||"member"===role||"admin"===role)}isCampaignAdmin(campaignName){return this.isSuperUser()||this.isAdmin()||"admin"===this.getCampaignRole(campaignName)}isCampaignGuest(campaignName){return this.isSuperUser()||this.isAdmin()||"guest"===this.getCampaignRole(campaignName)}getCampaignRole(campaignName){if(null==campaignName)return;const memberships=this.getCampaignMemberships();if(null==memberships)return;const role=memberships[campaignName.toLowerCase()];return token.u.some((roleName=>roleName===role))?role:void 0}getCampaignMemberships(){const data=TokenMockService_1.getUserData(),campaignMemberships={};for(const campaignIdentifier of Object.keys(data.campaignMemberships)){campaignIdentifier.startsWith(this.ID_IDENTIFIER_PREFIX)||(campaignMemberships[campaignIdentifier.toLowerCase()]=data.campaignMemberships[campaignIdentifier])}return campaignMemberships}isAccessTokenExpired(){return this.isTokenExpired(TokenMockService_1.getAccessToken())}isRefreshTokenExpired(){return this.isTokenExpired(TokenMockService_1.getRefreshToken())}isTokenExpired(token){const expiryTimestamp=token.exp,currentTimestamp=Math.floor((new Date).getTime()/1e3),isExpired=currentTimestamp>=expiryTimestamp;return isExpired&&console.log(`${token.type} Token is expired. Request timestamp: ${new Date(1e3*currentTimestamp).toString()}. Token expiry timestamp: ${new Date(1e3*expiryTimestamp).toString()}`),isExpired}};TokenMockService=TokenMockService_1=(0,tslib_es6.Cg)([(0,core.Injectable)({providedIn:"root"})],TokenMockService);var token_service=__webpack_require__("./src/app/_services/utils/token.service.ts");var profile_componentngResource=__webpack_require__("./src/design/templates/profile/profile.component.scss?ngResource"),profile_componentngResource_default=__webpack_require__.n(profile_componentngResource),common=__webpack_require__("./node_modules/@angular/common/fesm2022/common.mjs"),router=__webpack_require__("./node_modules/@angular/router/fesm2022/router.mjs"),formly_service_service=__webpack_require__("./src/app/_services/formly/formly-service.service.ts"),alert_component=__webpack_require__("./src/design/atoms/alert/alert.component.ts"),button_component=__webpack_require__("./src/design/atoms/button/button.component.ts"),card_component=__webpack_require__("./src/design/atoms/card/card.component.ts"),icon_component=__webpack_require__("./src/design/atoms/icon/icon.component.ts"),separator_component=__webpack_require__("./src/design/atoms/separator/separator.component.ts"),confirmation_toggle_button_component=__webpack_require__("./src/design/molecules/confirmation-toggle-button/confirmation-toggle-button.component.ts"),form_component=__webpack_require__("./src/design/molecules/form/form.component.ts"),page_container_component=__webpack_require__("./src/design/organisms/page-container/page-container.component.ts");let ProfileComponent=class ProfileComponent{constructor(formlyService){this.formlyService=formlyService,this.canDeleteProfile=!1,this.showProfileEditForm=!1,this.showPasswordEditForm=!1,this.backUrl=core.input.required(),this.profileUpdate=new core.EventEmitter,this.passwordUpdate=new core.EventEmitter,this.campaignLeave=new core.EventEmitter,this.profileDelete=new core.EventEmitter,this.passwordModel={},this.passwordFields=[this.formlyService.buildSinglePasswordConfig({key:"oldPassword",label:"Your old password"}),this.formlyService.buildConfirmedPasswordConfig({label:"New Password"})],this.profileModel={},this.profileFields=[this.formlyService.buildInputConfig({key:"username",inputKind:"STRING"}),this.formlyService.buildInputConfig({key:"email",required:!1,inputKind:"STRING"})]}toggleProfileEditState(){this.showProfileEditForm=!this.showProfileEditForm,this.showProfileEditForm&&(this.profileModel={username:this.user.username,email:this.user.email})}submitProfileUpdate(){this.profileUpdate.emit(this.profileModel),this.showProfileEditForm=!1}togglePasswordEditState(){this.showPasswordEditForm=!this.showPasswordEditForm,this.showPasswordEditForm&&(this.passwordModel={})}updatePassword(){const hasNewPassword=null!=this.passwordModel.password,hasOldPassword=null!=this.passwordModel.oldPassword;hasNewPassword&&hasOldPassword&&(this.passwordUpdate.emit(this.passwordModel),this.showPasswordEditForm=!1)}toggleLeaveCampaignState(membership){membership.isLeaving=!membership.isLeaving}static{this.ctorParameters=()=>[{type:formly_service_service.$}]}static{this.propDecorators={user:[{type:core.Input}],memberships:[{type:core.Input}],canDeleteProfile:[{type:core.Input}],showProfileEditForm:[{type:core.Input}],showPasswordEditForm:[{type:core.Input}],campaignName:[{type:core.Input}],backUrl:[{type:core.Input,args:[{isSignal:!0,alias:"backUrl",required:!0,transform:void 0}]}],profileUpdate:[{type:core.Output}],passwordUpdate:[{type:core.Output}],campaignLeave:[{type:core.Output}],profileDelete:[{type:core.Output}]}}};ProfileComponent=(0,tslib_es6.Cg)([(0,core.Component)({selector:"app-profile",template:'<app-page-container>\n  <article class="profile">\n    \x3c!-- Section Heading --\x3e\n    <div class="row profile__heading heading">\n      <h1 class="col-12 col-sm-6 heading__text">\n        <app-icon [icon]="\'circle-user\'"></app-icon>\n        Profile\n      </h1>\n\n      \x3c!-- Header Buttons --\x3e\n      <div class="col-12 col-sm-6 heading__buttons">\n        <button\n          btn\n          class="heading__button"\n          [kind]="\'SECONDARY\'"\n          [icon]="showProfileEditForm ? \'times\' : \'pencil\'"\n          [text]="showProfileEditForm ? \'Cancel Profile Edit\' : \'Edit Profile\'"\n          (click)="toggleProfileEditState()"\n        ></button>\n\n        <button\n          btn\n          class="heading__button"\n          [kind]="\'SECONDARY\'"\n          [icon]="showPasswordEditForm ? \'times\' : \'pencil\'"\n          [text]="\n            showPasswordEditForm ? \'Cancel Password Edit\' : \'Edit Password\'\n          "\n          (click)="togglePasswordEditState()"\n        ></button>\n      </div>\n    </div>\n\n    <app-separator></app-separator>\n\n    \x3c!-- Profile --\x3e\n    @if (!showProfileEditForm) {\n      <div class="row profile__data">\n        <h3>Profile Data</h3>\n        <div class="col-4">Username</div>\n        <div class="col-8">{{ user.username }}</div>\n        <div class="col-4">Email</div>\n        <div class="col-8">{{ user.email }}</div>\n      </div>\n      <div class="row profile__memberships">\n        <h3>Campaign Memberships</h3>\n        @for (membership of memberships; track membership; let i = $index) {\n          <div>\n            <ng-container\n              *ngTemplateOutlet="\n                membership.isLeaving ? leaveCampaignForm : displayCampaignForm;\n                context: { $implicit: { membership, index: i } }\n              "\n            ></ng-container>\n          </div>\n        }\n      </div>\n    } @else {\n      <app-card>\n        <app-form\n          [model]="profileModel"\n          [fields]="profileFields"\n          [cancelButtonType]="\'DARK\'"\n          (formlyCancel)="toggleProfileEditState()"\n          (formlySubmit)="submitProfileUpdate()"\n        ></app-form>\n      </app-card>\n    }\n\n    \x3c!-- Password Form --\x3e\n    @if (showPasswordEditForm) {\n      <app-card>\n        <app-form\n          [model]="passwordModel"\n          [fields]="passwordFields"\n          [cancelButtonType]="\'DARK\'"\n          (formlyCancel)="togglePasswordEditState()"\n          (formlySubmit)="updatePassword()"\n        ></app-form>\n      </app-card>\n    }\n\n    <div class="mt-5 row justify-content-between">\n      <div class="col-md-3">\n        <a [routerLink]="backUrl()" class="w-100">\n          <button\n            btn\n            [kind]="\'SECONDARY\'"\n            [text]="\n              campaignName ? \'Back To \' + campaignName : \'Back to Campaigns\'\n            "\n          ></button>\n        </a>\n      </div>\n\n      @if (canDeleteProfile) {\n        <div class="col-md-3">\n          <app-confirmation-toggle-button\n            [confirmationQuestion]="\'Delete your account?\'"\n            [icon]="\'trash\'"\n            (confirm)="profileDelete.emit(user)"\n          ></app-confirmation-toggle-button>\n        </div>\n      }\n    </div>\n  </article>\n</app-page-container>\n\n<ng-template #displayCampaignForm let-context>\n  <div class="row">\n    <div class="col-5">{{ context.membership.campaignName | titlecase }}</div>\n    <div class="col-4">{{ context.membership.role | titlecase }}</div>\n    <div class="col-3 d-flex justify-content-end">\n      <button\n        btn\n        [kind]="\'SECONDARY\'"\n        [icon]="\'sign-out-alt\'"\n        [size]="\'SMALL\'"\n        (click)="toggleLeaveCampaignState(context.membership)"\n      ></button>\n    </div>\n  </div>\n</ng-template>\n\n<ng-template #leaveCampaignForm let-context>\n  <app-alert [kind]="\'DANGER\'" class="row">\n    <div class="col-md-8">\n      <strong\n        >Permanently leave \'{{\n          context.membership.campaignName | titlecase\n        }}\'?</strong\n      >\n    </div>\n    <button\n      btn\n      class="col-md-2"\n      [kind]="\'DANGER\'"\n      [text]="\'Yes\'"\n      (click)="campaignLeave.emit(context.membership)"\n    ></button>\n    <button\n      btn\n      class="col-md-2"\n      [kind]="\'DARK\'"\n      [text]="\'No\'"\n      (click)="toggleLeaveCampaignState(context.membership)"\n    ></button>\n  </app-alert>\n</ng-template>\n',standalone:!0,imports:[page_container_component.i,icon_component.R,button_component.Q,separator_component.F,common.NgTemplateOutlet,card_component.i,form_component.s,router.Wk,confirmation_toggle_button_component.T,alert_component.C,common.TitleCasePipe],styles:[profile_componentngResource_default()]})],ProfileComponent);const profile_stories={title:"DesignSystem/Templates/ProfileComponent",component:ProfileComponent,decorators:[(0,angular_dist.moduleMetadata)({imports:[testing.c,formly_constants.d_],providers:[{provide:token_service.B,useClass:TokenMockService}]})],args:{user:{username:"john_doe",password:"password123",pk:1,api_permissions:["read","write"],groups:[1,2],group_details:[{name:"Group A",pk:1},{name:"Group B",pk:2}],is_staff:!1,is_superuser:!1,email:"john_doe@example-long-email-address.com",is_active:!0},campaignName:"Aldrune",memberships:[{campaignName:"Campaign A",role:"admin",isLeaving:!1},{campaignName:"Campaign B",role:"member",isLeaving:!1},{campaignName:"Campaign C",role:"guest",isLeaving:!1}],canDeleteProfile:!0,showProfileEditForm:!1,showPasswordEditForm:!1}},Default=(args=>({props:{...args,profileUpdate:(0,dist.XI)("profileUpdate"),profileDelete:(0,dist.XI)("profileDelete"),campaignLeave:(0,dist.XI)("campaignLeave"),passwordUpdate:(0,dist.XI)("passwordUpdate")}})).bind({});Default.args={};const __namedExportsOrder=["Default"];Default.parameters={...Default.parameters,docs:{...Default.parameters?.docs,source:{originalSource:"args => ({\n  props: {\n    ...args,\n    profileUpdate: action('profileUpdate'),\n    profileDelete: action('profileDelete'),\n    campaignLeave: action('campaignLeave'),\n    passwordUpdate: action('passwordUpdate')\n  }\n})",...Default.parameters?.docs?.source}}}},"./src/design/atoms/card/card.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".accordion {\n  --bs-accordion-active-bg: var(--bs-gray-900) !important;\n}\n\nbutton.btn.btn-link:hover {\n  text-decoration: none !important;\n}\n\nbutton.btn.btn-link:focus {\n  text-decoration: none !important;\n  box-shadow: none !important;\n}\n\n.card button.btn.btn-link {\n  width: 100%;\n  text-align: left;\n}\n\n.form-control {\n  height: 2.75rem;\n  font-size: 1.2rem;\n}\n\ninput.form-control {\n  background-color: transparent !important;\n  color: white !important;\n  border: solid white 1px !important;\n}\n\ninput.form-control:focus {\n  box-shadow: 3px blue;\n  color: white;\n}\n\nselect.form-select {\n  color: white !important;\n  background-color: #4c4c4c !important;\n}\n\nselect:focus {\n  background-color: #4c4c4c;\n  box-shadow: 3px blue;\n  color: white;\n}\n\noption {\n  background-color: #1b1f22;\n  color: white;\n  font-size: 18px;\n}\n\n.custom-control.custom-checkbox {\n  transform: scale(1.2);\n  transform-origin: 0;\n}\n\n.visually-hidden {\n  display: none;\n}\n\n.tooltip-inner {\n  --bs-tooltip-bg: var(--bs-info-bg-subtle);\n  --bs-tooltip-color: var(--bs-emphasis-color);\n}\n\n:host {\n  --card-bg-color: #393e41 !important;\n  --card-flex-direction: column;\n  --card-padding: var(--spacer-4);\n}\n\n.card {\n  background-color: var(--card-bg-color);\n  margin-top: var(--spacer-3);\n  margin-bottom: var(--spacer-3);\n  padding: var(--card-padding);\n  flex-direction: var(--card-flex-direction);\n  width: 100%;\n  height: 100%;\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/design/organisms/page-container/page-container.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".page {\n  width: 100%;\n  display: flex;\n  justify-content: center;\n}\n.page__background {\n  position: fixed;\n  top: 0;\n  left: 0;\n  z-index: -2;\n  width: 100%;\n  height: 100mvh;\n}\n.page__foreground {\n  max-width: 60rem;\n  width: 100%;\n  background-color: var(--wiki-bg-transparent);\n  padding: var(--spacer-3) var(--spacer-3) var(--spacer-5) var(--spacer-3);\n  margin-bottom: var(--spacer-4);\n  color: white;\n}\n@media (min-width: 768px) {\n  .page__foreground {\n    border-radius: var(--bs-border-radius);\n  }\n}\n@media (min-width: 992px) {\n  .page__foreground {\n    padding: var(--spacer-4);\n  }\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()},"./src/design/templates/profile/profile.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".profile__data {\n  margin-bottom: var(--spacer-4);\n}\n\n.heading {\n  display: flex;\n  justify-content: space-between;\n}\n.heading__text {\n  margin-bottom: var(--spacer-0);\n}\n.heading__buttons {\n  position: relative;\n  display: flex;\n  align-self: flex-end;\n  justify-content: flex-end;\n  top: 1px;\n}\n.heading__button {\n  border: var(--bs-white) 1px solid;\n  border-radius: var(--bs-border-radius);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);