(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[489],{"./src/app/design/templates/organization/organization.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,NoPermission:()=>NoPermission,default:()=>organization_stories});var testing=__webpack_require__("./node_modules/@angular/router/fesm2020/testing.mjs"),ngx_formly_core=__webpack_require__("./node_modules/@ngx-formly/core/fesm2020/ngx-formly-core.mjs"),dist=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),angular_dist=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),validators=__webpack_require__("./src/app/_services/formly/validators.ts"),molecules=__webpack_require__("./src/app/design/molecules/index.ts"),organisms=__webpack_require__("./src/app/design/organisms/index.ts"),tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _class,organization_componentngResource=__webpack_require__("./src/app/design/templates/organization/organization.component.scss?ngResource"),organization_componentngResource_default=__webpack_require__.n(organization_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),routing_service=__webpack_require__("./src/app/_services/routing.service.ts");let OrganizationComponent=((_class=class OrganizationComponent{constructor(routingService){this.routingService=routingService,this.canUpdate=!1,this.canCreate=!1,this.canDelete=!1,this.createImage=new core.EventEmitter,this.deleteImage=new core.EventEmitter,this.updateImage=new core.EventEmitter,this.organizationDelete=new core.EventEmitter}ngOnInit(){const campaignName=this.organization.campaign_details?.name;this.overviewUrl=this.routingService.getRoutePath("organization-overview",{campaign:campaignName}),this.setUrls(),this.setOrganizationMembers()}ngOnChanges(){this.setUrls(),this.setOrganizationMembers()}routeToCharacterCreation(){this.routingService.routeToPath("character-create",{campaign:this.organization.campaign_details?.name})}setOrganizationMembers(){this.organizationMembers=this.organization.members?.map((member=>({label:member.name,link:this.routingService.getRoutePath("character",{campaign:this.organization.campaign_details?.name,name:member.name})})))??[]}setUrls(){const campaignName=this.organization.campaign_details?.name;this.updateUrl=this.routingService.getRoutePath("organization-update",{campaign:campaignName,name:this.organization.name}),this.headquarterUrl=this.routingService.getRoutePath("location",{campaign:campaignName,name:this.organization.headquarter_details?.name,parent_name:this.organization.headquarter_details?.parent_name}),this.leaderUrl=this.routingService.getRoutePath("character",{campaign:campaignName,name:this.organization.leader})}}).ctorParameters=()=>[{type:routing_service.Z}],_class.propDecorators={organization:[{type:core.Input}],serverUrl:[{type:core.Input}],imageServerModel:[{type:core.Input}],canUpdate:[{type:core.Input}],canCreate:[{type:core.Input}],canDelete:[{type:core.Input}],createImage:[{type:core.Output}],deleteImage:[{type:core.Output}],updateImage:[{type:core.Output}],organizationDelete:[{type:core.Output}]},_class);OrganizationComponent=(0,tslib_es6.gn)([(0,core.Component)({selector:"app-organization",template:'<article class="container">\n  <ng-container *ngIf="canUpdate">\n    <div class="organization__edit-container">\n      <a [routerLink]="updateUrl">\n        <app-button\n          [icon]="\'pencil\'"\n          [type]="\'SECONDARY\'"\n        ></app-button>\n      </a>\n    </div>\n  </ng-container>\n\n  \x3c!-- Heading --\x3e\n  <div class="row">\n    <h1 class="col-12 organization__heading"> \n      {{ organization.name }} \n    </h1>\n    \x3c!-- Leader-Subheading --\x3e\n    <div class="col-12 organization__subheading"> \n        Leader: \n        <ng-container *ngIf="organization.leader; else Unknown">\n            <strong>\n                <a class="ms-1" [routerLink]="leaderUrl">\n                    {{ organization.leader }}\n                </a>\n            </strong>\n        </ng-container>\n    </div>\n\n    \x3c!-- Headquarters Subheading --\x3e\n    <div class="col-12 organization__subheading"> \n        Headquarters:\n        <ng-container *ngIf="organization.headquarter_details; else Unknown">\n            <strong>    \n                <a class="ms-1" [routerLink]="headquarterUrl">\n                    {{ organization.headquarter_details.name_full }}\n                </a>\n            </strong>\n        </ng-container>\n    </div>\n  </div>\n\n  \x3c!-- Image Gallery --\x3e\n  <div class="organization__images">\n    <app-image-carousel-card\n      [images]="organization.images ?? []"\n      [serverUrl]="serverUrl"\n      [serverModel]="imageServerModel"\n      [canUpdate]="canUpdate"\n      [canCreate]="canCreate"\n      [canDelete]="canDelete"\n      (createImage)="createImage.emit($event)"\n      (deleteImage)="deleteImage.emit($event)"\n      (updateImage)="updateImage.emit($event)"\n    ></app-image-carousel-card>\n  </div>\n\n  \x3c!-- Description --\x3e\n  <div class="organization__description">\n    <h4> Description </h4>\n    <app-html-text\n      [text]="organization.description"\n    ></app-html-text>\n  </div>\n\n  \x3c!-- Members --\x3e\n  <div class="organization__members">\n    <app-list\n      [heading]="\'Members\'"\n      [entries]="organizationMembers"\n      [enableCreate]="canCreate"\n      [emptyListText]="\'You know no member of \' + organization.name"\n      (create)="routeToCharacterCreation()"\n    ></app-list>\n  </div>\n\n  \x3c!-- Footer (Move to other Article + Delete Article) --\x3e\n  <app-article-footer\n    [buttonLink]="overviewUrl"\n    [buttonLabel]="\'Back to Organizations\'"\n    [showDelete]="canDelete"\n    [deleteMessage]="\'Delete \' + organization.name + \'?\'"\n    (delete)="organizationDelete.emit(organization)"\n  ></app-article-footer>\n</article>\n\n<ng-template #Unknown>Unknown</ng-template>\n',styles:[organization_componentngResource_default()]})],OrganizationComponent);const organization_stories={title:"DesignSystem/Templates/OrganizationComponent",component:OrganizationComponent,decorators:[(0,angular_dist.moduleMetadata)({imports:[organisms.kJ,testing.Z_,ngx_formly_core.X0.forRoot({types:[{name:"file",component:molecules.nE,wrappers:["form-field"]}],validationMessages:[validators.Bw,validators.l$],validators:[validators.np,validators.x5]})],declarations:[]})],args:{imageServerModel:void 0,canCreate:!0,canUpdate:!0,canDelete:!0,organization:{pk:123,name:"Order of the Silver Lance",description:"A knightly order dedicated to protecting the innocent.",leader:"Sir Cedric",headquarter:456,headquarter_details:{name:"Castle Silverkeep",parent_name:"Kingdom of Arathia",pk:456,name_full:"Castle Silverkeep, Kingdom of Arathia"},members:[{name:"Sir Cedric",pk:789,alive:!0,organization_id:123,role:"Grandmaster"},{name:"Lady Elspeth",pk:790,alive:!0,organization_id:123,role:"Commander"},{name:"Sir Richard",pk:791,alive:!1,organization_id:123,role:"Knight"}],images:[{pk:234,image:"/breeds/mastiff-tibetan/n02108551_5830.jpg",name:"Order Emblem",organization_article:123,article_type:"Organization"},{pk:235,image:"/breeds/mastiff-tibetan/n02108551_5830.jpg",name:"Order Emblem",organization_article:123,article_type:"Organization"}],campaign:1,campaign_details:{pk:1,name:"Campaign of Adventures"},creation_datetime:"2022-04-01T12:00:00Z",update_datetime:"2022-04-03T09:30:00Z",getAbsoluteRouterUrl:()=>"https://example.com/organizations/123"},serverUrl:"https://images.dog.ceo"}},Template=args=>({props:{...args,createImage:(0,dist.aD)("createImage"),deleteImage:(0,dist.aD)("deleteImage"),updateImage:(0,dist.aD)("updateImage"),organizationDelete:(0,dist.aD)("organizationDelete")}}),Default=Template.bind({});Default.args={};const NoPermission=Template.bind({});NoPermission.args={canDelete:!1,canUpdate:!1,canCreate:!1}},"./src/app/_services/formly/validators.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Be:()=>requiredIconMessage,Bo:()=>fieldsDontMatchMessage,Bw:()=>requiredMessage,Ds:()=>hasSpecialCharactersMessage,K7:()=>requiredIconValidator,Kg:()=>sessionAuthorUniqueValidator,U3:()=>iconValidator,UP:()=>invalidTimeMessage,YM:()=>timeValidator,_7:()=>fieldMatchValidator,cc:()=>specialCharacterValidator,eS:()=>sessionAlreadyHasAuthor,l$:()=>notIntegerMessage,np:()=>requiredValidator,ol:()=>dateMessage,sm:()=>dateValidator,ud:()=>faPrefixMessage,x5:()=>integerValidator});var _home_runner_work_nimstoryfont_gui_nimstoryfont_gui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js");const invalidTimeMessage={name:"time",message:"Time must have 'hh:mm:ss' pattern"},requiredMessage={name:"required",message:"This field is required!"},dateMessage={name:"date",message:"This date does not follow the pattern: 'YYYY-MM-DD'. Sorry to be such a Nazi about it. The computer is forcing me."},requiredIconMessage={name:"requiredIcon",message:"This field requires a fontawesome icon as input. Here is a list of them: https://fontawesome.com/v4.7.0/icons/"},faPrefixMessage={name:"faPrefix",message:"Icons are stored without the 'fa-' from font-awesome prefix"},notIntegerMessage={name:"notInteger",message:"Your input is not an integer. This field requires an integer number. No amount of revolution can overcome this."},hasSpecialCharactersMessage={name:"hasSpecialCharacters",message:'Your input includes one of the following invalid special characters: [ ] ( ) ? | \\ " % ~ # < > :. If you need to rebel, please dont against this.'},fieldsDontMatchMessage={name:"fieldMatch",message:"Password Not Matching"},sessionAlreadyHasAuthor={name:"isInvalidSessionAuthorPair",message:"\n    The author you selected already has a diaryentry in the session you selected. You \n    can't have 2 diaryentries from the same author in the same session. Consider writing \n    your diaryentry as an encounter instead into the diaryentry at the spot you just considered."};const timeValidator={name:"time",validation:function timeValidation(control){const isValidTime=/\d\d.[0-5]\d.[0-5]\d/.test(control.value);return isValidTime?null:{time:!isValidTime}}};function requiredValidation(control){return!!control.value||0===control.value?null:{required:!0}}const requiredValidator={name:"required",validation:requiredValidation},requiredIconValidator={name:"requiredIcon",validation:requiredValidation};const dateValidator={name:"date",validation:function dateValidation(control){return/[1-2]\d{3}-(0\d|1[0-2])-[0-3]\d/.test(control.value)?null:{date:!0}}};const iconValidator={name:"faPrefix",validation:function iconValidation(control){const hasFaPrefix=/fa-/.test(control.value);return hasFaPrefix?null:{faPrefix:hasFaPrefix}}};const integerValidator={name:"notInteger",validation:function isIntegerValidation(control){const isInteger="number"==typeof control.value&&Number.isInteger(control.value);return isInteger?null:{notInteger:!isInteger}}};const specialCharacterValidator={name:"hasSpecialCharacters",validation:function hasNoSpecialCharactersValidation(control){if("string"==typeof control.value){const specialCharacters=["[","]","(",")","|","\\",'"',"%","~","#","<",">","?","/",":"];for(const specialCharacter of specialCharacters)if(control.value.includes(specialCharacter))return{hasSpecialCharacters:!0}}return null}};const fieldMatchValidator={name:"fieldMatch",validation:function passwordMatchValidation(control){const{password,passwordConfirm}=control.value;return passwordConfirm&&password?passwordConfirm===password?{passwordMatch:!0}:null:{passwordMatch:!0}}};function _isSessionAuthorPairUniqueValidator(){return(_isSessionAuthorPairUniqueValidator=(0,_home_runner_work_nimstoryfont_gui_nimstoryfont_gui_node_modules_babel_runtime_helpers_esm_asyncToGenerator_js__WEBPACK_IMPORTED_MODULE_0__.Z)((function*(control){const{session:selectedSessionId,author:selectedAuthorId}=control.value,selectFieldOptionsObs=control.controls.session._fields[0].templateOptions.options,selectedOption=(yield selectFieldOptionsObs.toPromise()).find((option=>option.pk===selectedSessionId));if(null==selectedOption)throw"WeirdError. You selected a session, its id got into the model and somehow that field is no longer among the options (?)";const selectedAuthorAlreadyHasDiaryentryOnSession=selectedOption.author_ids.includes(selectedAuthorId),isInitialValue=control.pristine;return selectedAuthorAlreadyHasDiaryentryOnSession&&!isInitialValue?{passwordMatch:{message:"That account already has a diaryentry written for that session. Accounts can only have one Diaryentry per session"}}:{passwordMatch:null}}))).apply(this,arguments)}const sessionAuthorUniqueValidator={name:"sessionAuthorPairUnique",validation:function isSessionAuthorPairUniqueValidator(_x){return _isSessionAuthorPairUniqueValidator.apply(this,arguments)}}},"./node_modules/@storybook/addon-actions/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{aD:()=>chunk_KKE3V3AL.aD});var chunk_KKE3V3AL=__webpack_require__("./node_modules/@storybook/addon-actions/dist/chunk-KKE3V3AL.mjs");__webpack_require__("./node_modules/@storybook/addon-actions/dist/chunk-VWCVBQ22.mjs")},"./src/app/design/templates/organization/organization.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".organization__edit-container {\n  width: 100%;\n  display: flex;\n  justify-content: end;\n}\n.organization__heading {\n  text-align: center;\n}\n.organization__subheading {\n  text-align: center;\n}\n.organization__members {\n  margin-bottom: var(--spacer-5);\n}\n.organization__images {\n  margin-top: var(--spacer-3);\n  margin-bottom: var(--spacer-3);\n}\n.organization__description {\n  margin-bottom: var(--spacer-5);\n}\n\n.subheading__icon {\n  margin-left: var(--spacer-1);\n  margin-right: var(--spacer-1);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);