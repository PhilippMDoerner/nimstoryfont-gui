<form
  class="form"
  [formGroup]="form"
  [enctype]="enctype()"
  (submit)="onSubmit(undefined)"
>
  <formly-form
    [form]="form"
    [fields]="usedFields()"
    [model]="model()"
    [options]="{}"
  ></formly-form>

  @let errors = formErrors();
  @if (errors && errors.length > 0) {
    <div class="form__errors">
      @for (error of errors; track error) {
        <div class="invalid-feedback d-block">{{ error }}</div>
      }
    </div>
  }

  @if (!disabled() && enableSubmitButtons()) {
    <div class="form__button-container">
      <!-- Cancel Button -->
      <app-button
        class="form__button"
        [type]="cancelButtonType()"
        [icon]="'times'"
        [text]="'Cancel'"
        (click)="onCancel()"
      ></app-button>

      <!-- Submit Button -->
      <ng-container
        *ngTemplateOutlet="
          form.valid ? activeSubmitButton : inactiveSubmitButton
        "
      />
    </div>
  }
</form>

<ng-template #activeSubmitButton>
  <app-button
    class="form__button"
    [type]="submitButtonType()"
    [text]="'Submit'"
    [icon]="submitIcon()"
    [isSubmitButton]="true"
  ></app-button>
</ng-template>

<ng-template #inactiveSubmitButton>
  <app-button
    class="form__button"
    placement="top"
    [type]="'DARK'"
    [ngbTooltip]="'The form is not yet correctly filled out!'"
    [tooltipClass]="'my-tooltip'"
    [icon]="'lock'"
    [text]="'Submit'"
  ></app-button>
</ng-template>
