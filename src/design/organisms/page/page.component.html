@let campaign = globalStore.currentCampaign();
@if (campaign) {
  <div class="mobile">
    <nav class="navbar bg-dark">
      <div class="container-fluid">
        @if (canShowSidebar()) {
          <button
            class="navbar-toggler"
            type="button"
            data-bs-toggle="offcanvas"
            data-bs-target="#offcanvasNavbar"
            aria-controls="sidebar"
            aria-label="Toggle navigation"
            (click)="openSidebar()"
          >
            <app-icon [icon]="'bars'" />
          </button>
        }
        <a class="navbar-brand" [routerLink]="homeUrl()">
          <strong>
            <img
              class="navbar-brand-icon"
              [src]="serverUrl() + globalStore.currentCampaign()?.icon"
              alt="To Home Page"
            />
            {{ titleService.currentPageTitle() }}
          </strong>
        </a>
      </div>
    </nav>
  </div>

  @if (canShowSidebar()) {
    <div class="desktop">
      <ng-template *ngTemplateOutlet="sidebar" />
    </div>
  }
}

<div class="page" #content>
  <div class="page__content" #innerContent>
    <router-outlet #routerOutlet></router-outlet>
  </div>

  <app-page-background
    #background
    class="page__background"
    [imageUrl]="(campaignBackgroundImage$ | async) ?? undefined"
    [serverUrl]="serverUrl()"
  ></app-page-background>
</div>

<ng-template #sidebar>
  <app-sidebar
    #sidebarElement
    id="sidebar"
    class="sidebar"
    [campaign]="campaign"
    [hasCampaignAdminPrivileges]="hasCampaignAdminPrivileges()"
    (logout)="logout.emit()"
    (closeSidebar)="closeSidebar()"
    (click)="closeSidebar()"
  ></app-sidebar>
</ng-template>
