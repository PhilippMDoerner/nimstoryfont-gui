(self.webpackChunknimstoryfont_gui=self.webpackChunknimstoryfont_gui||[]).push([[1701],{"./src/app/design/organisms/quote/quote.stories.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{Default:()=>Default,NoPermission:()=>NoPermission,default:()=>__WEBPACK_DEFAULT_EXPORT__});var _angular_router_testing__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/@angular/router/fesm2020/testing.mjs"),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),_storybook_angular__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/angular/dist/index.mjs"),_molecules__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./src/app/design/molecules/index.ts");const dummyCharacters=[{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gandalf",pk:1,name_full:"Gandalf the Grey",player_character:!0,images:[{pk:1,image:"http://example.com/gandalf.jpg",name:"Gandalf portrait",character_article:1,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0}]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Frodo",pk:2,name_full:"Frodo Baggins",player_character:!0,images:[]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gimli",pk:3,name_full:"Gimli son of Glóin",player_character:!1,images:[]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Legolas",pk:4,name_full:"Legolas Greenleaf",player_character:!1,images:[{pk:2,image:"http://example.com/legolas.jpg",name:"Legolas portrait",character_article:4,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0}]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Bilbo",pk:5,name_full:"Bilbo Baggins",player_character:!1,images:[]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Aragorn",pk:6,name_full:"Aragorn son of Arathorn",player_character:!1,images:[{pk:3,image:"http://example.com/aragorn.jpg",name:"Aragorn portrait",character_article:6,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0}]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Saruman",pk:7,name_full:"Saruman the White",player_character:!1,images:[]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Sif",pk:18,name_full:"Sif the Swift",description:"Sif is a skilled warrior known for her lightning-fast strikes and agility. She is fiercely loyal to her friends and will stop at nothing to protect them.",update_datetime:"2022-03-15T10:30:00.000Z",player_character:!0,images:[]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Gorin",pk:19,name_full:"Gorin Ironfist",description:"Gorin is a dwarf from the Iron Hills, known for his strength and unwavering determination. He has a fondness for ale and a good brawl.",update_datetime:"2022-02-23T14:15:00.000Z",player_character:!0,images:[{pk:42,image:"https://example.com/images/gorin1.jpg",name:"Gorin 1",character_article:19,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0},{pk:43,image:"https://example.com/images/gorin2.jpg",name:"Gorin 2",character_article:19,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0}]},{getAbsoluteRouterUrl:()=>"/character/456",article_type:"Character",name:"Lirien",pk:20,name_full:"Lirien Windrider",description:"Lirien is an elven archer, renowned for her skill with the bow. She is fiercely independent and often clashes with authority figures.",update_datetime:"2022-03-20T08:45:00.000Z",player_character:!0,images:[{pk:44,image:"https://example.com/images/lirien1.jpg",name:"Lirien 1",character_article:20,creature_article:void 0,encounter_article:void 0,item_article:void 0,location_article:void 0,organization_article:void 0,article_type:"Character",imageFile:void 0}]}],__WEBPACK_DEFAULT_EXPORT__={title:"DesignSystem/Organisms/QuoteComponent",component:__webpack_require__("./src/app/design/organisms/quote/quote.component.ts").d,decorators:[(0,_storybook_angular__WEBPACK_IMPORTED_MODULE_1__.moduleMetadata)({imports:[_molecules__WEBPACK_IMPORTED_MODULE_2__._V,_angular_router_testing__WEBPACK_IMPORTED_MODULE_4__.Z_],declarations:[]})],args:{quote:{quote:"In the darkest of times, the light within us shines the brightest.",description:"Said by a wise old wizard to a young hero about to embark on a perilous quest.",pk:1,session:3,creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",session_details:{pk:3,is_main_session:!0,is_main_session_int:1,session_number:3,session_date:"2023-04-20",start_day:1,end_day:5,name:"The Quest for the Sacred Amulet",title:"The Quest"},encounter:2,connections:[{character:1,character_details:{pk:1,name:"Gandalf",name_full:"Gandalf the Grey"},quote:2,pk:2},{character:2,character_details:{pk:2,name:"Frodo",name_full:"Frodo Baggins"},quote:3,pk:3}]},character:{getAbsoluteRouterUrl:()=>"/dummy/url",player_character:!1,alive:!0,name:"Gandalf",title:"Gandalf the Grey",gender:"Male",race:"Maia",description:"A wise and powerful wizard, Gandalf the Grey is a member of the Fellowship of the Ring and a key figure in the fight against the Dark Lord Sauron.",organizations:[{pk:1,name:"The White Council",organization_id:1,role:"Member"},{pk:2,name:"The Fellowship of the Ring",organization_id:2,role:"Member"}],current_location:3,current_location_details:{pk:3,name_full:"Moria",parent_location:"Middle-earth"},items:[{pk:1,name:"Glamdring"},{pk:2,name:"Staff"}],encounters:[{name:"The Council of Elrond",creation_datetime:"2023-04-22T12:00:00.000Z",update_datetime:"2023-04-23T12:00:00.000Z",title:"Council of Elrond",diaryentry:50,order_index:20,encounterConnections:[{pk:1,encounter:2,character:3},{pk:2,encounter:3,character:4}],description:"At the Council of Elrond, Gandalf reveals the true nature of the One Ring and urges the Fellowship to destroy it in the fires of Mount Doom.",pk:1,campaign_details:{name:"Aldrune",pk:1}},{name:"The Battle of Helm's Deep",title:"The Battle of Helm's Deep",diaryentry:20,order_index:30,creation_datetime:"2023-04-23T12:00:00.000Z",update_datetime:"2023-04-24T12:00:00.000Z",encounterConnections:[{pk:324,encounter:223,encounter_details:{name:"Main Session 6 - A new job",name_full:"Main Session 6 - A new job",pk:223},character:43,character_details:{name:"Aliana Sterent",name_full:"Aliana Sterent",pk:43}},{pk:325,encounter:223,encounter_details:{name:"Main Session 6 - A new job",name_full:"Main Session 6 - A new job",pk:223},character:29,character_details:{name:"Ateula",name_full:"Ateula",pk:29}}],description:"Gandalf arrives at Helm's Deep with reinforcements and turns the tide of the battle against Saruman's forces.",pk:2,campaign_details:{name:"Aldrune",pk:1}}],images:[],player_class_connections:[{pk:1,player_class:8,character:5,player_class_details:{update_datetime:"2023-04-24T12:00:00.000Z",name:"Paladin",pk:8}}],campaign:1,campaign_details:{pk:1,name:"The War of the Ring"}},canCreate:!0,canUpdate:!0,canDelete:!0,campaignCharacters:dummyCharacters}},Template=args=>({props:{...args,quoteDelete:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("quoteDelete"),quoteCreate:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("quoteCreate"),quoteUpdate:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("quoteUpdate"),refreshQuote:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("refreshQuote"),connectionDelete:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("connectionDelete"),connectionCreate:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_0__.aD)("connectionCreate")}}),Default=Template.bind({});Default.args={};const NoPermission=Template.bind({});NoPermission.args={canCreate:!1,canUpdate:!1,canDelete:!1}},"./src/app/_services/routing.service.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{Z:()=>RoutingService});var _class,tslib__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/tslib/tslib.es6.js"),_angular_core__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),_angular_router__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/@angular/router/fesm2020/router.mjs");let RoutingService=((_class=class RoutingService{constructor(router){this.router=router,this.NONE_STRING="None",this.router.routeReuseStrategy.shouldReuseRoute=()=>!1}routeToPath(routeName,params={}){const routePath=this.getRoutePath(routeName,params),cleanedObjectUrl=this.replaceSpecialUnicodeCharacters(routePath);this.router.navigateByUrl(cleanedObjectUrl)}getRoutePath(routeName,params={}){return"Dummy/url"}routeToErrorPage(error){if("number"!=typeof error&&!error.hasOwnProperty("status"))throw"Incorrect error input. The input does not contain an error status or an object with the error status. Can not route to error page without error status.";"number"!=typeof error&&error.hasOwnProperty("status")&&(error=error.status);const errorStatusParam=`${error}`;this.routeToPath("error",{errorStatus:errorStatusParam})}routeNameMatches(route,routeName){return route.snapshot.data.name===routeName}replaceSpecialUnicodeCharacters(routePath){return routePath.replace("(","%28").replace(")","%29").replace("?","?").replace("†","%E2%80%A0")}getVariableRouteByName(routeName){const routesWithRouteName=this.getRoutesWithName(routeName);switch(routesWithRouteName.length){case 1:return routesWithRouteName[0];case 0:throw`There is no route with the name ${routeName}. Please contact the Developer to use either a different route name or create a route for this name.`;default:throw`There is more than 1 route with the name ${routeName}. Please contact the Developer to ensure all routes have unique names.`}}getVariableRoutePathByName(routeName){return this.getVariableRouteByName(routeName).path}hasPathVariables(routePath){return routePath.includes("/:")}hasRoutePath(routeName){return this.getRoutesWithName(routeName).length>0}getRoutesWithName(routeName){return this.router.config.filter((pathObject=>{const routeData=pathObject.data;return null!=routeData&&routeData.name===routeName}))}getPathVariableNames(routePath){const pathVariables=routePath.split("/").filter((segment=>segment.startsWith(":")));return pathVariables.map((segment=>segment.slice(1)))}}).ctorParameters=()=>[{type:_angular_router__WEBPACK_IMPORTED_MODULE_0__.F0}],_class);RoutingService=(0,tslib__WEBPACK_IMPORTED_MODULE_1__.gn)([(0,_angular_core__WEBPACK_IMPORTED_MODULE_2__.Injectable)({providedIn:"root"})],RoutingService)},"./src/app/design/organisms/quote/quote.component.ts":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{d:()=>QuoteComponent});var tslib_es6=__webpack_require__("./node_modules/tslib/tslib.es6.js");var _class,quote_componentngResource=__webpack_require__("./src/app/design/organisms/quote/quote.component.scss?ngResource"),quote_componentngResource_default=__webpack_require__.n(quote_componentngResource),core=__webpack_require__("./node_modules/@angular/core/fesm2020/core.mjs"),routing_service=__webpack_require__("./src/app/_services/routing.service.ts");function copyToClipboard(text){const windowSelection=window.getSelection(),documentSelection=window.getSelection();var userSelectedTextRange=void 0;(function userHasElementsSelected(){const selection=document.getSelection();if(null==selection)return!1;return selection?.rangeCount>0})()&&(userSelectedTextRange=documentSelection.getRangeAt(0),windowSelection.removeRange(userSelectedTextRange));const textContainerElement=function createTextContainerElement(text){const textContainerElement=document.createElement("div");textContainerElement.innerHTML=text;const strippedText=textContainerElement.textContent;return textContainerElement.innerHTML=strippedText.replaceAll(">","<br>> ").slice("<br>".length),textContainerElement.style.position="absolute",textContainerElement.style.left="-9999px",textContainerElement}(text);document.body.appendChild(textContainerElement);const copyRange=function selectElement(element){const selectedRange=document.createRange();return selectedRange.selectNode(element),window.getSelection()?.addRange(selectedRange),selectedRange}(textContainerElement);!function copyCurrentSelection(){try{document.execCommand("copy")}catch(err){window.alert("Your Browser Doesn't support this! Error : "+err)}}(),windowSelection.removeRange(copyRange),document.body.removeChild(textContainerElement),userSelectedTextRange&&windowSelection.addRange(userSelectedTextRange)}let QuoteComponent=((_class=class QuoteComponent{constructor(routingService){this.routingService=routingService,this.canCreate=!1,this.canUpdate=!1,this.canDelete=!1,this.quoteDelete=new core.EventEmitter,this.quoteCreate=new core.EventEmitter,this.quoteUpdate=new core.EventEmitter,this.connectionDelete=new core.EventEmitter,this.connectionCreate=new core.EventEmitter,this.refreshQuote=new core.EventEmitter,this.state="DISPLAY",this.badgeEntries=[],this.isLoadingQuote=!1}ngOnInit(){this.badgeEntries=this.parseConnection(this.quote?.connections??[]),this.campaignName=this.character.campaign_details?.name,this.quoteOverviewUrl=this.routingService.getRoutePath("quote-overview",{name:this.character.name,campaign:this.campaignName})}ngOnChanges(){this.isLoadingQuote=!1}onConnectionDelete(connection){this.canDelete&&this.connectionDelete.emit(connection)}onConnectionCreate(character){if(!this.canCreate||!this.quote)return;const newConnection={quote:this.quote.pk,character:character.pk};this.connectionCreate.emit(newConnection)}getNextRandomQuote(){this.isLoadingQuote=!0,this.refreshQuote.emit()}parseConnection(connections){return connections.map((con=>{const characterName=con.character_details?.name;return{text:characterName,badgeValue:con,link:this.routingService.getRoutePath("character",{name:characterName,campaign:this.campaignName})}}))}copyQuoteToClipboard(){if(!this.quote)return;copyToClipboard(`${this.quote.quote.split("<br />").map((line=>`>${line.trim().trimStart()}`)).join("<br />")}\n>${`- ${this.quote.description} `}`)}}).ctorParameters=()=>[{type:routing_service.Z}],_class.propDecorators={quote:[{type:core.Input}],character:[{type:core.Input}],campaignCharacters:[{type:core.Input}],canCreate:[{type:core.Input}],canUpdate:[{type:core.Input}],canDelete:[{type:core.Input}],quoteDelete:[{type:core.Output}],quoteCreate:[{type:core.Output}],quoteUpdate:[{type:core.Output}],connectionDelete:[{type:core.Output}],connectionCreate:[{type:core.Output}],refreshQuote:[{type:core.Output}]},_class);QuoteComponent=(0,tslib_es6.gn)([(0,core.Component)({selector:"app-quote",template:'<ng-container *ngIf="quote">\n  <ng-container *ngIf="!isLoadingQuote; else loading">\n    <div class="field">\n      <blockquote class="field__content quote">\n        \x3c!-- Quote --\x3e\n        <app-html-text class="quote__text" [text]="quote.quote"></app-html-text>\n  \n        \x3c!-- Quote Description --\x3e\n        <div class="quote__description">\n          <ng-container *ngIf="quote.description">\n            <app-html-text\n              [text]="\'- \' + quote.description"\n            ></app-html-text>\n          </ng-container>\n  \n          <ng-container *ngIf="!quote.description">\n            - {{ character.name }}\n          </ng-container>\n        </div>\n  \n        <app-separator></app-separator>\n  \n        \x3c!-- Quote Connections --\x3e\n        <div class="quote__connections d-inline icon-container">\n          <app-badge-list\n            [entries]="badgeEntries"\n            [label]="\'Characters\'"\n            [createOptions]="{\n              options: campaignCharacters,\n              labelProp: \'name\',\n              valueProp: \'pk\'\n            }"\n            [canCreate]="canCreate"\n            [canDelete]="canDelete"\n            [cancelButtonType]="\'DARK\'"\n            (entryCreate)="onConnectionCreate($event)"\n            (entryDelete)="onConnectionDelete($event)"\n          ></app-badge-list>\n        </div>\n      </blockquote>\n  \n      \x3c!-- Quote Refresh/Create/Edit/Delete Icons --\x3e\n      <div class="field__controls">\n        \x3c!-- Load Next Quote --\x3e\n        <app-button \n          class="field__control"\n          title="Load new quote"\n          [type]="\'INFO\'"\n          [icon]="\'refresh\'"\n          (click)="getNextRandomQuote()"\n        ></app-button>\n        \n        \x3c!-- Edit Quote --\x3e\n        <ng-container *ngIf="canUpdate">\n          <app-button\n            class="field__control"\n            title="Edit Quote"\n            [type]="\'SECONDARY\'"\n            [icon]="\'pencil\'"\n            (click)="quoteUpdate.emit(quote)"\n          ></app-button>\n        </ng-container>\n  \n        \x3c!-- Create Quote --\x3e\n        <ng-container *ngIf="canCreate">\n          <app-button\n            class="field__control"\n            title="Create Quote"\n            [type]="\'PRIMARY\'"\n            [icon]="\'plus\'"\n            (click)="quoteCreate.emit()"\n          ></app-button>\n        </ng-container>\n  \n        \x3c!-- Delete Quote --\x3e\n        <ng-container *ngIf="canDelete">\n          <app-button\n            class="field__control"\n            title="Delete Quote"\n            [type]="\'DANGER\'"\n            [icon]="\'trash\'"\n            (click)="quoteDelete.emit(quote)"\n          ></app-button>\n        </ng-container>\n  \n        \x3c!-- Copy to Clipboard --\x3e\n        <app-button\n          class="field__control"\n          title="Copy Quote to Clipboard"\n          [type]="\'DARK\'"\n          [icon]="\'copy\'"\n          (click)="copyQuoteToClipboard()"\n        ></app-button>\n        \n        \x3c!-- Hyperlink to Quote Overview --\x3e\n        <a [routerLink]="quoteOverviewUrl">\n          <app-button\n            class="field__control"\n            title="See all quotes"\n            [type]="\'SECONDARY\'"\n            [icon]="\'th-list\'"\n          ></app-button>\n        </a>\n  \n      </div>\n    </div>\n  </ng-container>\n</ng-container>\n\n<ng-template #loading>\n  <app-spinner></app-spinner>\n</ng-template>',styles:[quote_componentngResource_default()]})],QuoteComponent)},"./node_modules/@storybook/addon-actions/dist/index.mjs":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{"use strict";__webpack_require__.d(__webpack_exports__,{aD:()=>chunk_KKE3V3AL.aD});var chunk_KKE3V3AL=__webpack_require__("./node_modules/@storybook/addon-actions/dist/chunk-KKE3V3AL.mjs");__webpack_require__("./node_modules/@storybook/addon-actions/dist/chunk-VWCVBQ22.mjs")},"./src/app/design/organisms/quote/quote.component.scss?ngResource":(module,__unused_webpack_exports,__webpack_require__)=>{var ___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/noSourceMaps.js"),___CSS_LOADER_EXPORT___=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js")(___CSS_LOADER_API_NO_SOURCEMAP_IMPORT___);___CSS_LOADER_EXPORT___.push([module.id,".field {\n  margin-bottom: var(--spacer-3);\n}\n.field__controls {\n  margin-top: var(--spacer-1);\n}\n.field__control {\n  margin-left: var(--spacer-3);\n  margin-right: var(--spacer-3);\n  display: inline-block;\n  width: -moz-fit-content;\n  width: fit-content;\n}\n\n.quote__description {\n  margin: var(--spacer-3) var(--spacer-0) var(--spacer-3) var(--spacer-3);\n}",""]),module.exports=___CSS_LOADER_EXPORT___.toString()}}]);